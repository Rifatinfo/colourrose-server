
model Order {
  id String @id @default(cuid())

  userId String
  user   User   @relation(fields: [userId], references: [id])

  name    String
  state   String
  phone   String
  address String

  subtotal    Float
  totalAmount Float

  orderStatus   OrderStatus   @default(PENDING)
  paymentStatus PaymentStatus @default(UNPAID)
  paymentMethod PaymentMethod

  deliveryCharge Decimal?
  deliveryType   DeliveryType?
  items   OrderItem[]
  // Relation to Payment
  payment Payment?    @relation("OrderPayment") // optional one-to-one
  shipmentTrackings ShipmentTracking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("orders")
}

model OrderItem {
  id        String @id @default(cuid())
  orderId   String
  productId String

  productName String
  price       Float
  quantity    Int
  total       Float

  color     String?
  size      String?
  variantId String?
  // Relations
  variant   Variant? @relation(fields: [variantId], references: [id], onDelete: SetNull)
  product   Product  @relation(fields: [productId], references: [id])
  order     Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("order_items")
}

model ShipmentTracking {
  id        String          @id @default(uuid())
  orderId  String
  status   ShipmentStatus
  message  String?
  location String?
  createdAt DateTime        @default(now())

  order     Order           @relation(fields: [orderId], references: [id])
}

